<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="sys21_campos_zukarmex.Views.AuthorizationPage" 
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui" 
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml" 
             xmlns:viewmodels="clr-namespace:sys21_campos_zukarmex.ViewModels"
             xmlns:behaviors="clr-namespace:sys21_campos_zukarmex.Behaviors"
             xmlns:apiresponse="clr-namespace:sys21_campos_zukarmex.Models.DTOs.Api" 
             x:DataType="viewmodels:AuthorizationViewModel" 
             Title="{Binding Title}" 
             BackgroundColor="{DynamicResource Gray100}">

    <Grid RowDefinitions="Auto,*">
        <ScrollView>
            <StackLayout Spacing="20" Padding="20">

                <Frame BackgroundColor="{DynamicResource Primary}" CornerRadius="15" HasShadow="True">
                    <Label Text="Precipitación Pluvial" FontSize="20" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center" />
                </Frame>

                <Frame BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True">
                    <StackLayout Spacing="15">

                        <StackLayout>
                            <Label Text="Empresa" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Picker ItemsSource="{Binding Empresas}"
                                    SelectedItem="{Binding SelectedEmpresa}"
                                    ItemDisplayBinding="{Binding Nombre}"
                                    Title="Seleccione una empresa"
                                    FontSize="16" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Fecha" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <DatePicker Date="{Binding Fecha}"
                                        Format="dd/MM/yyyy"
                                        FontSize="16" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Pluviometro" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Picker ItemsSource="{Binding Pluviometros}"
                                    SelectedItem="{Binding SelectedPluviometro}"
                                    ItemDisplayBinding="{Binding Nombre}"
                                    Title="Seleccione un Pluviometro"
                                    FontSize="16" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Precipitación en Milímetros" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Entry Text="{Binding Precipitacion}"
                                   Placeholder="0"
                                   Keyboard="Numeric"
                                   FontSize="16"
                                   HorizontalTextAlignment="Center">
                                    <Entry.Behaviors>
                                        <behaviors:NumericValidationBehavior />
                                    </Entry.Behaviors>
                                </Entry>
                            </Frame>
                        </StackLayout>

                    </StackLayout>
                </Frame>

                <Button Text="Añadir"
                    Command="{Binding AddRainfallCommand}"
                    BackgroundColor="{StaticResource Primary}"
                    TextColor="White"
                    CornerRadius="25"
                    HeightRequest="50"
                    FontSize="18"
                    FontAttributes="Bold"
                    Margin="0,10,0,0"/>

            </StackLayout>
        </ScrollView>

        <ActivityIndicator IsRunning="{Binding IsBusy}" 
                           IsVisible="{Binding IsBusy}" 
                           Color="{DynamicResource Primary}" 
                           VerticalOptions="Center" 
                           HorizontalOptions="Center" />
    </Grid>

</ContentPage>

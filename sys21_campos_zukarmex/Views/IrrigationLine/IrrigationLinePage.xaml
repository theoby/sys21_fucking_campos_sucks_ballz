<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:sys21_campos_zukarmex.ViewModels"
             xmlns:behaviors="clr-namespace:sys21_campos_zukarmex.Behaviors"
             x:Class="sys21_campos_zukarmex.Views.IrrigationLine.IrrigationLinePage"
             x:DataType="viewmodels:IrrigationLineViewModel"
             xmlns:system="clr-namespace:System;assembly=netstandard"
             Title="{Binding Title}"
             BackgroundColor="{DynamicResource Gray100}">

    <Grid RowDefinitions="*">

        <ScrollView Grid.Row="0">
            <StackLayout Spacing="20" Padding="20">

                <Frame BackgroundColor="{DynamicResource Primary}" CornerRadius="15" HasShadow="True">
                    <Label Text="Línea de Riego" 
                           FontSize="20" 
                           FontAttributes="Bold"
                           TextColor="White"
                           HorizontalOptions="Center"/>
                </Frame>

                <Frame BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True">
                    <StackLayout Spacing="15">

                        <StackLayout>
                            <Label Text="Predio" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Picker ItemsSource="{Binding Predios}"           
                                        SelectedItem="{Binding SelectedPredio}"   
                                        ItemDisplayBinding="{Binding Nombre}"     
                                        Title="Seleccione un predio"
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        TitleColor="{StaticResource Gray600}"/>
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Línea de Riego" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Picker ItemsSource="{Binding LineasDeRiego}"         
                                        SelectedItem="{Binding SelectedLineaDeRiego}"  
                                        ItemDisplayBinding="{Binding Nombre}"
                                        Title="Seleccione una línea de riego"
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        TitleColor="{StaticResource Gray600}"/>
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Fecha" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <DatePicker Date="{Binding Fecha}" 
                                            Format="dd/MM/yyyy"
                                            FontSize="16"
                                            BackgroundColor="Transparent"
                                            MaximumDate="{x:Static Member=system:DateTime.Today}"
                                            MinimumDate="{Binding MinDate}"
                                            x:Name="DateInput" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Equipo de bombeo" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Entry Text="{Binding EquipoDeBombeo}"
                                       Placeholder="Ingrese el equipo de bombeo"
                                       Keyboard="Text"
                                       FontSize="16"
                                       BackgroundColor="Transparent"
                                       PlaceholderColor="{StaticResource Gray600}" 
                                       IsReadOnly="True"/>
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Equipos de bombeo operando" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Entry Text="{Binding EquiposDeBombeoOperando}"
                                       Placeholder="Número de equipos operando"
                                       Keyboard="Numeric"
                                       BackgroundColor="Transparent"
                                       PlaceholderColor="{StaticResource Gray600}">

                                    <Entry.Behaviors>
                                        <behaviors:NumericValidationBehavior />
                                    </Entry.Behaviors>

                                </Entry>
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Observación" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Editor Text="{Binding Observacion}"
                                        Placeholder="Ingrese cualquier observación"
                                        AutoSize="TextChanges"
                                        HeightRequest="80"
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        MaxLength="255"
                                        PlaceholderColor="{StaticResource Gray600}"
                                        TextColor="Black"/>
                            </Frame>
                        </StackLayout>

                    </StackLayout>
                </Frame>

                <Button Text="Añadir"
                        Command="{Binding AddIrrigationEntryCommand}"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="White"
                        CornerRadius="25"
                        HeightRequest="50"
                        FontSize="18"
                        FontAttributes="Bold"
                        Margin="0,10,0,0">
                    <Button.ImageSource>
                        <FontImageSource FontFamily="MaterialIcons"
                                         Glyph="+"
                                         Color="White"
                                         Size="22"/>
                    </Button.ImageSource>
                </Button>

            </StackLayout>
        </ScrollView>

        <ActivityIndicator IsRunning="{Binding IsBusy}" 
                           IsVisible="{Binding IsBusy}"
                           Color="{DynamicResource Primary}"
                           VerticalOptions="Center"
                           HorizontalOptions="Center" />
    </Grid>

</ContentPage>
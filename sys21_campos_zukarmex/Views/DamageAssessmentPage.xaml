<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="sys21_campos_zukarmex.Views.DamageAssessmentPage"
             Title="Muestreo de da침o">
    <Grid RowDefinitions="Auto,*">

        <ScrollView Grid.Row="1"
                    IsVisible="True"
                    Padding="20">
            <StackLayout Spacing="20">

                <Frame BackgroundColor="{DynamicResource Primary}"
                       CornerRadius="15"
                       HasShadow="True">
                    <StackLayout Spacing="10">
                        <Label Text="Muestreo de da침o"
                               FontSize="20"
                               FontAttributes="Bold"
                               TextColor="White"
                               HorizontalOptions="Center" />
                    </StackLayout>
                </Frame>

                <Frame CornerRadius="10"
                       HasShadow="True"
                       Padding="6"
                       Margin="0"
                       HorizontalOptions="Fill"
                       IsVisible="False">
                    <Frame.Triggers>
                        <DataTrigger TargetType="Frame"
                                     Binding="{Binding RequiereAutorizacion}"
                                     Value="False">
                            <Setter Property="IsVisible"
                                    Value="True" />
                            <Setter Property="BackgroundColor"
                                    Value="{StaticResource Success}" />
                        </DataTrigger>
                        <DataTrigger TargetType="Frame"
                                     Binding="{Binding RequiereAutorizacion}"
                                     Value="True">
                            <Setter Property="IsVisible"
                                    Value="True" />
                            <Setter Property="BackgroundColor"
                                    Value="{StaticResource Warning}" />
                        </DataTrigger>
                    </Frame.Triggers>
                    <StackLayout Spacing="0"
                                 HorizontalOptions="Center">
                        <Label x:Name="LblAutorizacion"
                               Text=""
                               FontSize="15"
                               FontAttributes="Bold"
                               TextColor="White"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"
                               LineBreakMode="NoWrap"
                               Margin="0">
                            <Label.Triggers>
                                <DataTrigger TargetType="Label"
                                             Binding="{Binding RequiereAutorizacion}"
                                             Value="False">
                                    <Setter Property="Text"
                                            Value="Este vale no requiere autorizaci칩n." />
                                </DataTrigger>
                                <DataTrigger TargetType="Label"
                                             Binding="{Binding RequiereAutorizacion}"
                                             Value="True">
                                    <Setter Property="Text"
                                            Value="Este vale requiere autorizaci칩n." />
                                </DataTrigger>
                            </Label.Triggers>
                        </Label>
                    </StackLayout>
                </Frame>

                <Frame Grid.Row="0"
                       BackgroundColor="Orange"
                       Padding="10"
                       CornerRadius="15"
                       IsVisible="{Binding ConnectivitySvc.IsConnected, Converter={StaticResource InvertedBoolConverter}}">
                    <Label Text="No hay conexion, la captura se guardara en local"
                           TextColor="White"
                           FontAttributes="Bold"
                           HorizontalOptions="Center" />
                </Frame>

                <Frame BackgroundColor="White"
                       CornerRadius="15"
                       Padding="20"
                       HasShadow="True">
                    <StackLayout Spacing="15">

                        <StackLayout>
                            <Label Text="Predio"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <Picker ItemsSource="{Binding Predios}"
                                        SelectedItem="{Binding SelectedPredio}"
                                        ItemDisplayBinding="{Binding Nombre}"
                                        Title="Seleccione un predio"
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        IsEnabled="{Binding AreFieldsLocked, Converter={StaticResource InvertedBoolConverter}}" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Zafra"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <Picker ItemsSource="{Binding Zafras}"
                                        SelectedItem="{Binding SelectedZafra}"
                                        ItemDisplayBinding="{Binding Nombre}"
                                        Title="Seleccione una zafra"
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        IsEnabled="{Binding AreFieldsLocked, Converter={StaticResource InvertedBoolConverter}}" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Campo"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <Picker ItemsSource="{Binding Campos}"
                                        SelectedItem="{Binding SelectedCampo}"
                                        ItemDisplayBinding="{Binding Nombre}"
                                        Title="Seleccione un campo"
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        IsEnabled="{Binding AreFieldsLocked, Converter={StaticResource InvertedBoolConverter}}" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Ciclo"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <Picker ItemsSource="{Binding Ciclos}"
                                        SelectedItem="{Binding SelectedCiclo}"
                                        ItemDisplayBinding="{Binding Nombre}"
                                        Title="Seleccione un ciclo"
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        IsEnabled="{Binding AreFieldsLocked, Converter={StaticResource InvertedBoolConverter}}" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Fecha"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <DatePicker Date="{Binding FechaMuestreo}"
                                            FontSize="16"
                                            BackgroundColor="Transparent"
                                            Format="dd/MM/yyyy"
                                            IsEnabled="{Binding AreFieldsLocked, Converter={StaticResource InvertedBoolConverter}}" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Superficie"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <Entry Text="{Binding Superficie}"
                                       Placeholder="Superficie"
                                       Keyboard="Numeric"
                                       FontSize="16"
                                       BackgroundColor="Transparent" />
                            </Frame>
                        </StackLayout>


                        <StackLayout HorizontalOptions="Fill">
                            <Label Text="N춿 de tallos"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <Entry Text="{Binding NumeroTallos}"
                                       Placeholder="0"
                                       Keyboard="Numeric"
                                       FontSize="16"
                                       BackgroundColor="Transparent" />
                            </Frame>
                        </StackLayout>

                        <StackLayout HorizontalOptions="Fill">
                            <Label Text="N춿 de da침os"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <Entry Text="{Binding NumeroDanos}"
                                       Placeholder="0"
                                       Keyboard="Numeric"
                                       FontSize="16"
                                       BackgroundColor="Transparent" />
                            </Frame>
                        </StackLayout>


                        <Grid ColumnDefinitions="*, *"
                              ColumnSpacing="15">

                            <StackLayout Grid.Column="0">
                                <Label Text="N춿 de tallos"
                                       FontSize="14"
                                       TextColor="{StaticResource Gray600}" />
                                <Frame BackgroundColor="{StaticResource Gray100}"
                                       CornerRadius="10"
                                       Padding="0"
                                       HasShadow="False">
                                    <Entry Text="{Binding NumeroTallos}"
                                           Placeholder="0"
                                           Keyboard="Numeric"
                                           FontSize="16"
                                           BackgroundColor="Transparent"
                                           HorizontalTextAlignment="Center" />
                                </Frame>
                            </StackLayout>

                            <StackLayout Grid.Column="1">
                                <Label Text="N춿 de da침os"
                                       FontSize="14"
                                       TextColor="{StaticResource Gray600}" />
                                <Frame BackgroundColor="{StaticResource Gray100}"
                                       CornerRadius="10"
                                       Padding="0"
                                       HasShadow="False">
                                    <Entry Text="{Binding NumeroDanos}"
                                           Placeholder="0"
                                           Keyboard="Numeric"
                                           FontSize="16"
                                           BackgroundColor="Transparent"
                                           HorizontalTextAlignment="Center" />
                                </Frame>
                            </StackLayout>

                        </Grid>

                        <Grid ColumnDefinitions="*, *"
                              ColumnSpacing="15">

                            <StackLayout Grid.Column="0">
                                <Frame BackgroundColor="{StaticResource Gray500}"
                                       CornerRadius="10"
                                       Padding="10"
                                       HasShadow="False"
                                       HorizontalOptions="FillAndExpand"
                                       VerticalOptions="FillAndExpand"
                                       Grid.Column="1"
                                       Grid.Row="0"
                                       Grid.RowSpan="2">

                                    <StackLayout HorizontalOptions="Center"
                                                 VerticalOptions="Center">
                                        <Label Text="Total Da침o"
                                               TextColor="White"
                                               FontAttributes="Bold"
                                               FontSize="18"
                                               HorizontalOptions="Center" />

                                        <Label Text="0"
                                               TextColor="White"
                                               FontAttributes="Bold"
                                               FontSize="24"
                                               HorizontalOptions="Center" />
                                    </StackLayout>

                                </Frame>
                            </StackLayout>

                            <StackLayout Grid.Column="1">
                                <Frame BackgroundColor="{StaticResource Gray500}"
                                       CornerRadius="10"
                                       Padding="10"
                                       HasShadow="False"
                                       HorizontalOptions="FillAndExpand"
                                       VerticalOptions="FillAndExpand"
                                       Grid.Column="1"
                                       Grid.Row="0"
                                       Grid.RowSpan="2">

                                    <StackLayout HorizontalOptions="Center"
                                                 VerticalOptions="Center">
                                        <Label Text="% da침o"
                                               TextColor="White"
                                               FontAttributes="Bold"
                                               FontSize="18"
                                               HorizontalOptions="Center" />

                                        <Label Text="0.0%"
                                               TextColor="White"
                                               FontAttributes="Bold"
                                               FontSize="24"
                                               HorizontalOptions="Center" />
                                    </StackLayout>

                                </Frame>
                            </StackLayout>

                        </Grid>

                        <Button Text="+ Agregar"
                                Command="{Binding AddMuestreoCommand}"
                                BackgroundColor="{StaticResource Primary}"
                                TextColor="White"
                                CornerRadius="10"
                                FontSize="18"
                                HorizontalOptions="Center"
                                WidthRequest="200" />
                        <Button Text="游댌 Debug Recetas con Art칤culos"
                                Command="{Binding DebugRecetasConArticulosCommand}"
                                BackgroundColor="{StaticResource Gray600}"
                                TextColor="White"
                                CornerRadius="10"
                                FontSize="14"
                                Margin="0,10,0,0" />
                    </StackLayout>
                </Frame>
            </StackLayout>
        </ScrollView>

        <ActivityIndicator Grid.Row="1"
                           IsRunning="{Binding IsBusy}"
                           IsVisible="{Binding IsBusy}"
                           Color="{StaticResource Primary}"
                           VerticalOptions="Center"
                           HorizontalOptions="Center" />

    </Grid>
</ContentPage>
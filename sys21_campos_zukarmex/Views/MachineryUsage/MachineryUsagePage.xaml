<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="sys21_campos_zukarmex.Views.MachineryUsage.MachineryUsagePage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:sys21_campos_zukarmex.ViewModels"
             xmlns:behaviors="clr-namespace:sys21_campos_zukarmex.Behaviors"
             xmlns:models="clr-namespace:sys21_campos_zukarmex.Models"
             x:DataType="viewmodels:MachineryUsageViewModel"
             Title="Uso de Maquinaria"
             BackgroundColor="{DynamicResource Gray100}">

    <Grid RowDefinitions="Auto,*">

        <ScrollView>
            <StackLayout Spacing="20" Padding="20">

                <Frame BackgroundColor="{DynamicResource Primary}" CornerRadius="15" HasShadow="True">
                    <Label Text="Uso de Maquinaria" FontSize="20" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center" />
                </Frame>

                <Frame BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True">
                    <StackLayout Spacing="15">

                        <StackLayout>
                            <Label Text="Fecha"
                                   FontSize="14"
                                   TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}"
                                   CornerRadius="10"
                                   Padding="0"
                                   HasShadow="False">
                                <DatePicker BackgroundColor="Transparent"
                                            Date="{Binding Fecha}"
                                            FontSize="16"
                                            Format="dd/MM/yyyy" />
                            </Frame>
                        </StackLayout>
                        <StackLayout>
                            <Label Text="Equipos" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Picker BackgroundColor="Transparent" 
                                        ItemsSource="{Binding Equipos}" 
                                        SelectedItem="{Binding SelectedEquipo}" 
                                        ItemDisplayBinding="{Binding Nombre}" 
                                        Title="Seleccione un Equipo" FontSize="16"
                                        TitleColor="{StaticResource Gray600}" />
                            </Frame>
                        </StackLayout>

                        <StackLayout>
                            <Label Text="Campo" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Picker 
                                    BackgroundColor="Transparent" 
                                    ItemsSource="{Binding Campos}" 
                                    SelectedItem="{Binding SelectedCampo}" 
                                    ItemDisplayBinding="{Binding Nombre}" 
                                    Title="Seleccione un Campo" 
                                    FontSize="16"
                                    TitleColor="{StaticResource Gray600}" />
                            </Frame>
                        </StackLayout>

                        <Grid ColumnDefinitions="*,*" ColumnSpacing="15">
                            <StackLayout Grid.Column="0">
                                <Label Text="Horas Trabajadas" FontSize="14" TextColor="{StaticResource Gray600}" />
                                <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                    <Entry PlaceholderColor="{StaticResource Gray600}" BackgroundColor="Transparent" Text="{Binding HorasTrabajadas}" Placeholder="0" Keyboard="Numeric" FontSize="16" HorizontalTextAlignment="Center"
                                     >
                                        <Entry.Behaviors>
                                            <behaviors:NumericValidationBehavior />
                                        </Entry.Behaviors>
                                    </Entry>
                                </Frame>
                            </StackLayout>

                            <StackLayout Grid.Column="1">
                                <Label Text="Kilometraje" FontSize="14" TextColor="{StaticResource Gray600}" />
                                <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                    <Entry PlaceholderColor="{StaticResource Gray600}" BackgroundColor="Transparent" Text="{Binding KilometrajeOdometro}" Placeholder="0" Keyboard="Numeric" FontSize="16" HorizontalTextAlignment="Center"
                                      >
                                        <Entry.Behaviors>
                                            <behaviors:NumericValidationBehavior />
                                        </Entry.Behaviors>
                                    </Entry>
                                </Frame>
                            </StackLayout>
                        </Grid>
                    </StackLayout>
                </Frame>

                <Button Text="Añadir"
                    Command="{Binding SaveCommand}"
                    BackgroundColor="{StaticResource Primary}" TextColor="White" CornerRadius="25"
                    HeightRequest="50" FontSize="18" FontAttributes="Bold" Margin="0,10,0,0"/>

            </StackLayout>
        </ScrollView>

        <!-- Loading Indicator -->
        <ActivityIndicator IsRunning="{Binding IsBusy}" 
                           IsVisible="{Binding IsBusy}" 
                           Color="{StaticResource Primary}" 
                           VerticalOptions="Center" 
                           HorizontalOptions="Center" />

    </Grid>

</ContentPage>

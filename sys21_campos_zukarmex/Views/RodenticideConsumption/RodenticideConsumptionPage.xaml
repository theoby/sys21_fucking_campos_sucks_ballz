<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:sys21_campos_zukarmex.ViewModels"
             xmlns:behaviors="clr-namespace:sys21_campos_zukarmex.Behaviors"
             x:Class="sys21_campos_zukarmex.Views.RodenticideConsumption.RodenticideConsumptionPage"
             x:DataType="viewmodels:RodenticideConsumptionViewModel"
             Title="{Binding Title}"
             BackgroundColor="{DynamicResource Gray100}">

    <Grid>

        <ScrollView>
            <StackLayout Spacing="20" Padding="20">
                <Frame BackgroundColor="{DynamicResource Primary}" CornerRadius="15" HasShadow="True">
                    <Label Text="Consumo de Rodenticida" FontSize="20" FontAttributes="Bold" TextColor="White" HorizontalOptions="Center"/>
                </Frame>
                <Frame BackgroundColor="White" CornerRadius="15" Padding="20" HasShadow="True">
                    <StackLayout Spacing="15">
                        <StackLayout>
                            <Label Text="Zafra" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Picker ItemsSource="{Binding Zafras}" 
                                        SelectedItem="{Binding SelectedZafra}" 
                                        ItemDisplayBinding="{Binding Nombre}" 
                                        Title="Seleccione una Zafra" 
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        TitleColor="{StaticResource Gray600}" />
                            </Frame>
                        </StackLayout>
                        <StackLayout>
                            <Label Text="Predios" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <Picker ItemsSource="{Binding Campos}" 
                                        SelectedItem="{Binding SelectedCampo}" 
                                        ItemDisplayBinding="{Binding Nombre}" 
                                        Title="Seleccione un Predio" 
                                        FontSize="16"
                                        BackgroundColor="Transparent"
                                        TitleColor="{StaticResource Gray600}" />
                            </Frame>
                        </StackLayout>
                        <StackLayout>
                            <Label Text="Fecha" FontSize="14" TextColor="{StaticResource Gray600}" />
                            <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                <DatePicker Date="{Binding Fecha}" Format="dd/MM/yyyy" FontSize="16" />
                            </Frame>
                        </StackLayout>
                        <Grid ColumnDefinitions="*,*" ColumnSpacing="15" RowSpacing="10">
                            <StackLayout Grid.Column="0" Spacing="15">
                                <StackLayout>
                                    <Label Text="Comederos" FontSize="14" TextColor="{StaticResource Gray600}" />
                                    <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                        <Entry Text="{Binding CantidadComederos}" 
                                               Placeholder="0" 
                                               Keyboard="Numeric" 
                                               HorizontalTextAlignment="Center" 
                                               FontSize="16"
                                               BackgroundColor="Transparent"
                                               PlaceholderColor="{StaticResource Gray600}">
                                            <Entry.Behaviors>
                                                <behaviors:NumericValidationBehavior />
                                            </Entry.Behaviors>
                                        </Entry>
                                    </Frame>
                                </StackLayout>
                                <StackLayout>
                                    <Label Text="Pastillas" FontSize="14" TextColor="{StaticResource Gray600}" />
                                    <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                        <Entry Text="{Binding CantidadPastillas}" 
                                               Placeholder="0" 
                                               Keyboard="Numeric" 
                                               HorizontalTextAlignment="Center" 
                                               FontSize="16"
                                               BackgroundColor="Transparent"
                                               PlaceholderColor="{StaticResource Gray600}">
                                            <Entry.Behaviors>
                                                <behaviors:NumericValidationBehavior />
                                            </Entry.Behaviors>
                                        </Entry>
                                    </Frame>
                                </StackLayout>
                                <StackLayout>
                                    <Label Text="Consumo" FontSize="14" TextColor="{StaticResource Gray600}" />
                                    <Frame BackgroundColor="{StaticResource Gray100}" CornerRadius="10" Padding="0" HasShadow="False">
                                        <Entry Text="{Binding Consumo}" 
                                               Placeholder="0" 
                                               Keyboard="Numeric" 
                                               HorizontalTextAlignment="Center"
                                               FontSize="16"
                                               BackgroundColor="Transparent"
                                               PlaceholderColor="{StaticResource Gray600}">
                                            <Entry.Behaviors>
                                                <behaviors:NumericValidationBehavior />
                                            </Entry.Behaviors>
                                        </Entry>
                                    </Frame>
                                </StackLayout>
                            </StackLayout>
                            <StackLayout Grid.Column="1" Spacing="15">
                                <Frame BackgroundColor="{StaticResource Gray500}" CornerRadius="10" Padding="10" HasShadow="False" VerticalOptions="FillAndExpand">
                                    <StackLayout HorizontalOptions="Center" VerticalOptions="Center">
                                        <Label Text="Total Cebo" TextColor="White" FontAttributes="Bold" FontSize="18" HorizontalOptions="Center" />
                                        <Label Text="{Binding TotalCebo}" TextColor="White" FontAttributes="Bold" FontSize="24" HorizontalOptions="Center" />
                                    </StackLayout>
                                </Frame>
                                <Frame BackgroundColor="{StaticResource Gray500}" CornerRadius="10" Padding="10" HasShadow="False" VerticalOptions="FillAndExpand">
                                    <StackLayout HorizontalOptions="Center" VerticalOptions="Center">
                                        <Label Text="% de Consumo" TextColor="White" FontAttributes="Bold" FontSize="18" HorizontalOptions="Center" />
                                        <Label Text="{Binding PorcentajeConsumo, StringFormat='{0:P2}'}" TextColor="White" FontAttributes="Bold" FontSize="24" HorizontalOptions="Center" />
                                    </StackLayout>
                                </Frame>
                            </StackLayout>
                        </Grid>
                    </StackLayout>
                </Frame>
                <Button Text="AÃ±adir" Command="{Binding AddConsumptionCommand}" BackgroundColor="{StaticResource Primary}" TextColor="White" CornerRadius="25" HeightRequest="50" FontSize="18" FontAttributes="Bold" Margin="0,10,0,0"/>
            </StackLayout>
        </ScrollView>

        <ActivityIndicator IsRunning="{Binding IsBusy}" IsVisible="{Binding IsBusy}" Color="{StaticResource Primary}" VerticalOptions="Center" HorizontalOptions="Center" />

    </Grid>
</ContentPage>